<!DOCTYPE html>
{% csrf_token %}
<html lang="en">
<head>
  <title>Mybookscloud</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

<link href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round" rel="stylesheet">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>




<script>




$(window).load(function() {
  console.log('view');
   document.getElementById('spin').style.visibility='hidden';
   document.getElementById('spin1').style.visibility='hidden';
});






function signup_validation()
{
    var Firstname=document.forms['signupform']['Firstname'].value;
    var Lastname=document.forms['signupform']['Lastname'].value;
    var Username=document.forms['signupform']['Username'].value;
    var Email=document.forms['signupform']['Email'].value;
    var Password=document.forms['signupform']['Password'].value;
    var ConfirmPassword=document.forms['signupform']['ConfirmPassword'].value;


    Firstname=Firstname.trim()
    Lastname=Lastname.trim()
    Username=Username.trim()
    Email=Email.trim()
    reg_fname=/^[a-zA-Z]+$/;
    var passw = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,20}$/;
    ws=/\s/g;

    u_name=/^[0-9 a-zA-Z\-]+$/;
   if(Firstname=="" || !(Firstname.match(reg_fname)))
    {
      document.signupform.Firstname.focus()
      document.getElementById('fname').style.visibility='visible';
      return false;
    }
  else {
    document.getElementById('fname').style.visibility='hidden';
  }
    if(Lastname=="" || !(Lastname.match(reg_fname)))
     {
       document.signupform.Lastname.focus()
       document.getElementById('lname').style.visibility='visible';
       return false;
     }
     else {
        document.getElementById('lname').style.visibility='hidden';
     }
     if(Username=="" || !(Username.match(u_name)))
      {
        document.signupform.Username.focus()
        document.getElementById('uname').style.visibility='visible';
        return false;
      }
    else {
      document.getElementById('uname').style.visibility='hidden';
    }

    if(!Password.match(passw))
     {

       document.signupform.Password.focus()
       document.getElementById('pas').innerHTML='*invalid'
       document.getElementById('pas').style.visibility='visible';
       return false;

     }

    else {
      if ( Password.match(ws)) {
        document.getElementById('pas').innerHTML='*spaces are not allowed'
        document.getElementById('pas').style.visibility='visible';
        return false;
      }
     document.getElementById('pas').style.visibility='hidden';

    }

    if(!(Password == ConfirmPassword))
    {
      document.getElementById('cpass').style.visibility='visible';
      document.signupform.ConfirmPassword.focus()
      return false;


    }
 else {
   console.log('waiting')
   document.getElementById('spin').style.visibility='visible';
   return true;
 }



    //document.getElementById('ku1').style.visibility='visible';

}



function login_validations()
{
var Username=document.forms['loginform']['Username'].value;
var Password=document.forms['loginform']['Password'].value;
  Username=Username.trim()
  u_name=/^[0-9 a-zA-Z\-]+$/;
  var passw = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,20}$/;
    ws=/\s/g;
  if(Username=="" || !(Username.match(u_name)))
   {
     document.loginform.Username.focus()
     document.getElementById('lusername').style.visibility='visible';
     return false;
   }
 else {
   document.getElementById('lusername').style.visibility='hidden';
 }

 if(!Password.match(passw))
  {

    document.loginform.Password.focus()
    document.getElementById('lpassword').innerHTML='*invalid'
    document.getElementById('lpassword').style.visibility='visible';
    return false;

  }

 else {
   if ( Password.match(ws)) {
     document.getElementById('lpassword').innerHTML='*spaces are not allowed'
     document.getElementById('lpassword').style.visibility='visible';
     return false;
   }
      document.getElementById('lpassword').style.visibility='hidden';

 }
  console.log('login')
 document.getElementById('spin1').style.visibility='visible';
 return true;


}

function des()
{
  confirm('*Password 6 to 20 characters.\n*one numeric digit.\n*one uppercase.\n*one lowercase letter.')
}

</script>



<style media="screen">


.loader {

  border: 16px solid #f3f3f3;
  border-radius: 50%;
  border-top: 16px solid #3498db;
  width: 120px;
  height: 120px;
  -webkit-animation: spin 2s linear infinite; /* Safari */
  animation: spin 2s linear infinite;
  position: absolute;
  left: 35%;
  top: 40%;
  transform: translate(-50%, -50%);

}


/* Safari */
@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}






.jumbotron {
    background: rgba(0, 0, 0, 0.6);
}

body {
  background-image: radial-gradient(circle, rgb(77, 76, 76), white, rgb(186, 140, 140));
  background-repeat: no-repeat;
  background-size: cover;
   background-attachment: fixed;
}

.btn1 {
  border: none;
  background-color: inherit;
  padding: 14px 28px;
  font-size: 16px;
  cursor: pointer;
  display: inline-block;
}

.btn1:hover {background: rgb(0,10,255);}

.success {color: white;}



</style>

</head>
<body>





<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="#">My Cloud Books</a>
    </div>



    <ul class="nav navbar-nav">


    </ul>

  </div>
</nav>

<div class="container" style="margin-top:120px ;">
  <div class="jumbotron text-center">
    <h1 style="color:white;">My Cloud Books</h1>
    <br> <br>
<a href="#MyModal" class="trigger-btn" data-toggle="modal"><button id='display'  class="btn1 success" style="margin-right:25px;"><span class="glyphicon glyphicon-user"></span> &nbsp; Sign Up</button></a>
  <a href="#myModal" class="trigger-btn" data-toggle="modal"><button id='display1' class="btn1 success" style="margin-left:25px;"><span class="glyphicon glyphicon-log-in"></span> &nbsp; Login</button></a>

  </div>
</div>





<div id="myModal" class="modal fade">
  {% csrf_token %}
	<div class="modal-dialog modal-login">
		<div class="modal-content">
			<form action="login" method="post" name='loginform' onsubmit="return login_validations()">
        {% csrf_token %}
				<div class="modal-header">
					<h4 class="modal-title">Login</h4>
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				</div>
   {% csrf_token %}
				<div class="modal-body">
          {% for message in messages%}
        <h4 style="color:red; text-align:center; ">{{message}}</h4>
        {%endfor%}
          <div class="loader" id="spin1" ></div>
					<div class="form-group">
						<label>Username</label>
						<input type="text" class="form-control" name="Username"required="required"><span id='lusername' style="visibility:hidden;color:red;">invalid</span>
					</div>
					<div class="form-group">
						<div class="clearfix">
							<label>Password</label>
              {% csrf_token %}
							<a href="/reset" class="pull-right text-muted"><small>Forgot?</small></a>
						</div>
{% csrf_token %}
						<input type="password" class="form-control"name="Password" required="required"><span id='lpassword' style="visibility:hidden;color:red;">invalid</span>
					</div>
				</div>
				<div class="modal-footer">
      {% csrf_token %}
					<input type="submit" class="btn btn-primary" style="margin-right:232px;" value="Login">
				</div>
			</form>
		</div>
	</div>
</div>



<div id="MyModal" class="modal fade">
  {% csrf_token %}
	<div class="modal-dialog modal-login">
		<div class="modal-content">
			<form action="signup" method="post" name="signupform" onsubmit="return signup_validation()">
        {% csrf_token %}
				<div class="modal-header">
					<h4 class="modal-title">Sign Up</h4>
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				</div>
				<div class="modal-body">
          {%if data%}
          {% for message in messages%}
        <h4 style="color:red; text-align:center; ">{{message}}</h4>
        {%endfor%}
        {%endif%}
          <div class="loader" id="spin" ></div>
					<div class="form-group">
						<label>Firstname*</label>
						<input type="text" class="form-control" name="Firstname" required="required"><span id='fname' style="visibility:hidden;color:red;">*invalid, allowed characters[ a-z A-Z ]</span>
					</div>

          <div class="form-group">
 						<label>Lastname*</label>
 						<input type="text" class="form-control" name="Lastname" required="required"><span id='lname' style="visibility:hidden;color:red;">*invalid,  allowed characters[ a-z A-Z ]</span>
 					</div>


          <div class="form-group">
            <label>Username*</label>
            <input type="text" class="form-control" name="Username"required="required"><span id='uname' style="visibility:hidden;color:red;">*invalid, allowed characters[ a-z A-Z 0-9 ]</span>
          </div>

          <div class="form-group">
            <label>Email*</label>
            <input type="email" class="form-control" name="Email" required="required"><span id='email'  style="visibility:hidden;color:red;">*invalid email address</span>
          </div>

					<div class="form-group">
						<div class="clearfix">
							<label>Password*</label>

						</div>
<span class="glyphicon glyphicon-info-sign " onmouseover="des()" id="pass"></span>
						<input type="password" class="form-control" name="Password"required="required"><span id='pas'  style="visibility:hidden;color:red;">*invald</span>
					</div>


          <div class="form-group">
            <div class="clearfix">
              <label>Confirm Password*</label>

            </div>

            <input type="password" class="form-control" name="ConfirmPassword"required="required"><span id='cpass' style="visibility:hidden;color:red;">*didn't match</span>
          </div>




        </div>




				<div class="modal-footer">
            {% csrf_token %}
					<input type="submit" class="btn btn-primary" style="margin-right:232px;" value="Sign Up">
				</div>
			</form>
		</div>
	</div>
</div>



<div id="pwdModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog">
  <div class="modal-content">
      <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
          <h1 class="text-center">What's My Password?</h1>
      </div>{% csrf_token %}
      <div class="modal-body">
          <div class="col-md-12">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <div class="text-center">

                          <p>If you have forgotten your password you can reset it here.</p>
                            <div class="panel-body">
                                <fieldset>
                                    <div class="form-group">
                                      <form action="sendemail" method="post">
                                       {%csrf_token%}

                                        <input class="form-control input-lg" placeholder="E-mail Address" name="email" type="email" required>
                                    </div>{% csrf_token %}
                                    <input class="btn btn-lg btn-primary btn-block" value="Send My Password" type="submit">
                                      </form>
                                </fieldset>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
      </div>
      <div class="modal-footer">
          <div class="col-md-12">
          <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
      </div>
      </div>
  </div>
  </div>
</div>





{%if data%}
<script type="text/javascript">

  document.getElementById('display').click()

  console.log('wait')
</script>
{%endif%}

{%if data1%}
<script type="text/javascript">

  document.getElementById('display1').click()

  console.log('wait')
</script>
{%endif%}
</body>
</html>
